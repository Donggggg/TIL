# HTTPS

## 정의

- HyperText Transfer Protocol over TLS/SSL의 준말이다.
- 기존의 HTTP 프로토콜을 암호화하여 보안을 강화한 버전이다.

## HTTPS의 동작원리를 알기 위한 사전 지식

### SSL/TLS

- SSL(Secure Sockets Layer)은 암호화 기반 인터넷 보안 프로토콜이다.
- SSL은 최신 기술인 TLS(Transport Layer Security)의 이전 버전이다.
- 응용계층과 전송계층 사이에 독립적인 프로토콜 계층을 만들어서 동작한다.

### 전자서명

![](https://i.imgur.com/YhS5KYE.png)

- 어떤 데이터가 그 사람의 것이 맞는지 보장해주는 것이다.
- 이때 `공개키 암호화 기술`이 사용된다.
- 공개키 방식의 특징인 A로 암호화한 것은 B로 복호화하고 그 역도 성립한다.
- 보통 하나의 키는 자신만이 가지고 있는 `비공개키` 나머지는 타인에게 제공하는 `공개키`라고 부른다.
- 개인키의 소유자는 개인키를 이용해서 정보를 암호화한 후에 공개키와 함께 암호화된 정보를 전송한다.
- 정보와 공개키를 획득한 사람은 공개키를 이용해서 암호화된 정보를 복호화하고 정보가 일치하면 해당 정보가 공개키를 제공한 곳에서 제공한 것이 맞다고 볼 수 있다.
- 즉, 공개키가 데이터를 제공한 사람의 신원을 보장해주는 것이고 이것이 `전자 서명`이다.

## SSL 실제 동작

![](https://i.imgur.com/YLJo63e.png)

1. 클라이언트가 서버에 요청을 보낸다.
2. TCP HandShake가 일어나고 완료된다. `#TCP 3-way handshake`
3. 클라이언트는 서버에게 `난수값C`과 `사용 가능한 암호 알고리즘 정보`를 보낸다. `#Client Hello`
4. 서버는 클라이언트에게 `인증서(서버의 공개키, 서버 정보 등)`와 `난수값S`을 보낸다. `#Server Hello`
5. 클라이언트는 브라우저의 `CA 리스트 중 일치하는 것`을 찾아 `해당 CA의 공개키`로 `인증서를 복호화`한다.
6. 복호화한 서버의 정보가 일치한다면 해당 인증서는 `CA의 개인키로 암호화`되고 `정상적으로 등록된 서버`임이 자명함으로 인증이 되었음을 알 수 있다. `#전자 서명`
7. 클라이언트가 보유한 `난수값C와 난수값S`를 이용하여 `세션키`를 만들어 서버의 공개키로 암호화하여 서버로 전송한다.
8. 서버는 `세션키`를 서버 개인키로 복호화하여 세션 키를 공유한다.
9. 이후에 `세션키`를 대칭키로 삼아 실제 데이터를 교환한다.

### 레퍼런스 및 이미지 출처

https://opentutorials.org/course/228/4894
